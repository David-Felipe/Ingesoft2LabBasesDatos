generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Vivienda {
  id        Int                    @id @default(autoincrement())
  direccion String                 @db.VarChar(45)
  tamano    Int                    
  pisos     Int
  municipioId Int
  municipio Municipio              @relation(fields: [municipioId], references: [id])
  personas  Persona[]              @relation("PersonaVivienda")
  viviendas Persona_has_Vivienda[]
}

model Departamento {
  nombre     String      @id @db.VarChar(30)
  area       Float       
  poblacion  Int         
  gobernador String      @db.VarChar(60)
  municipios Municipio[]
}

model Municipio {
  id                 Int          @id @default(autoincrement())
  nombre             String       @db.VarChar(30)
  area               Float        
  poblacion          Int          
  alcalde            String       @db.VarChar(60)
  departamentoNombre String
  departamento       Departamento @relation(fields: [departamentoNombre], references: [nombre])
  personas           Persona[]
  viviendas          Vivienda[]
}

model Persona {
  id              Int                    @id
  nombre          String                 @db.VarChar(60)
  telefono        String                 @db.VarChar(10)
  fechaNacimiento DateTime               
  genero          Int?
  viviendaId      Int
  municipioId     Int
  responsables    Dependientes[]         @relation("Dependientes")
  dependientes    Dependientes[]         @relation("Responsables")
  municipio       Municipio              @relation(fields: [municipioId], references: [id])
  vivienda        Vivienda               @relation("PersonaVivienda", fields: [viviendaId], references: [id])
  viviendas       Persona_has_Vivienda[]
}

model Dependientes {
  responsableId Int
  dependienteId Int
  dependiente   Persona @relation("Dependientes", fields: [dependienteId], references: [id])
  responsable   Persona @relation("Responsables", fields: [responsableId], references: [id])

  @@id([dependienteId, responsableId])
}

model Persona_has_Vivienda {
  personaId  Int
  viviendaId Int
  persona    Persona  @relation(fields: [personaId], references: [id])
  vivienda   Vivienda @relation(fields: [viviendaId], references: [id])

  @@id([personaId, viviendaId])
}
